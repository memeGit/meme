if(typeof $CONFIG=="undefined"||!$CONFIG){$CONFIG={}}var scope=$CONFIG;Function.prototype.bind2=function(object){var __method=this;return function(){return __method.apply(object,arguments)}};scope.isWeiboHost=false;scope.$VERSION="t35";scope.$BASEHOST="../../timg.sjs.sinajs.cn/default.htm";scope.$BASEIMG=scope.$BASECSS=scope.$BASEHOST="../../timg.sjs.sinajs.cn/"+scope.$VERSION+"/";scope.$OPENTIMG=scope.$BASEHOST+"../appstyle/opent/default.htm";scope.$BASESTYLE=scope.$BASEHOST+"style/";scope.$BLANKIMG=scope.$BASESTYLE+"images/common/transparent.gif";scope.$BASEJS="../../tjs.sjs.sinajs.cn/"+scope.$VERSION+"/";scope.$BASESTATIC="../../tjs.sjs.sinajs.cn/"+scope.$VERSION+"/";scope.$BASEHOST=/weibo.com/.test(location.hostname)?"weibo.com":"t.sina.com.cn";scope._ua=navigator.userAgent.toLowerCase();scope.$IE=/msie/.test(scope._ua);scope.$OPERA=/opera/.test(scope._ua);scope.$MOZ=/gecko/.test(scope._ua);scope.$IE5=/msie 5 /.test(scope._ua);scope.$IE55=/msie 5.5/.test(scope._ua);scope.$IE6=/msie 6/.test(scope._ua);scope.$IE7=/msie 7/.test(scope._ua);scope.$SAFARI=/safari/.test(scope._ua);scope.$winXP=/windows nt 5.1/.test(scope._ua);scope.$winVista=/windows nt 6.0/.test(scope._ua);var $IE=scope.$IE,$MOZ=scope.$MOZ,$IE6=scope.$IE6;function $Import(url){}var Boot={};Boot.addDOMLoadEvent=function(func){if(!window.__load_events){var init=function(){if(arguments.callee.done){return}arguments.callee.done=true;if(window.__load_timer){clearInterval(window.__load_timer);window.__load_timer=null}for(var i=0;i<window.__load_events.length;i++){window.__load_events[i]()}window.__load_events=null};if(document.addEventListener){document.addEventListener("DOMContentLoaded",init,false)}if(/WebKit/i.test(navigator.userAgent)){window.__load_timer=setInterval(function(){if(/loaded|complete/.test(document.readyState)){init()}},10)}if(window.ActiveXObject){window.__load_timer=setInterval(function(){try{document.body.doScroll("left");init()}catch(ex){}},10)}window.onload=init;window.__load_events=[]}window.__load_events.push(func)};Boot.getJsVersion=function(){var ver=false;if($CONFIG){ver=$CONFIG.js?$CONFIG.js:""}if(ver){return"@v="+ver}else{return""}};try{Boot.addDOMLoadEvent(main)}catch(e){}var $Debug=(function(){var contentList=[];function add_to_content(sText,oOpts,sCMD){var key;var text=sText!=null?sText:"";var opts={color:null,bgcolor:null,html:null};var cmd=sCMD!=null?sCMD:"log";oOpts=oOpts!=null?oOpts:{};for(key in opts){if(oOpts[key]!=null){opts[key]=oOpts[key]}}contentList.push({label:text,cmd:cmd,opts:opts,time:new Date()})}function debug_proto(sText,oOpts){add_to_content(sText,oOpts,"log")}debug_proto.fatal=function(sText,oOpts){add_to_content(sText,oOpts,"fatal")};debug_proto.error=function(sText,oOpts){add_to_content(sText,oOpts,"error")};debug_proto.warning=function(sText,oOpts){add_to_content(sText,oOpts,"warning")};debug_proto.info=function(sText,oOpts){add_to_content(sText,oOpts,"info")};debug_proto.log=function(sText,oOpts){add_to_content(sText,oOpts,"log")};debug_proto.clear=function(){contentList=[]};debug_proto.contentList=contentList;return debug_proto})();if(typeof trace=="undefined"){trace=traceError=$Debug}if(typeof Sina=="undefined"){Sina={}}Sina.pkg=function(ns){if(!ns||!ns.length){return null}var levels=ns.split(".");var nsobj=Sina;for(var i=(levels[0]=="Sina")?1:0;i<levels.length;++i){nsobj[levels[i]]=nsobj[levels[i]]||{};nsobj=nsobj[levels[i]]}return nsobj};function $E(oID){var node=typeof oID=="string"?document.getElementById(oID):oID;if(node!=null){return node}else{}return null}function $C(tagName){return document.createElement(tagName)}try{document.execCommand("BackgroundImageCache",false,true)}catch(e){}if(typeof Jobs=="undefined"){var Jobs={}}(function(){var isReady=false;var readyList=[];var timer;var ready=function(fn,jobName){var fun=function(){setTimeout(function(){var startTime=new Date();try{fn.call(document)}catch(e){$Debug.fatal("<b>Job ["+jobName+"] 执行失败!</b><br/>&nbsp;"+e.name+"<br/>&nbsp;"+(e.message||e.description)+(e.fileName?"<br/>&nbsp;"+e.fileName:"")+(e.lineNumber?"<br/>&nbsp;"+e.lineNumber:""),{html:true})}finally{$Debug.info("<b>Job ["+jobName+"] 执行("+(new Date()-startTime)+"毫秒)</b>",{html:true})}},10)};if(isReady){fun()}else{readyList.push(fun)}return this};var onDOMReady=function(){for(var i=0;i<readyList.length;i++){readyList[i]()}readyList=null};var bindReady=function(evt){if(isReady){return}isReady=true;onDOMReady.call(window);if(document.removeEventListener){document.removeEventListener("DOMContentLoaded",bindReady,false)}else{if(document.attachEvent){document.detachEvent("onreadystatechange",bindReady);if(window==window.top){clearInterval(timer);timer=null}}}};if(document.addEventListener){document.addEventListener("DOMContentLoaded",bindReady,false)}else{if(document.attachEvent){document.attachEvent("onreadystatechange",function(){if((/loaded|complete/).test(document.readyState)){bindReady()}});if(window==window.top){timer=setInterval(function(){try{isReady||document.documentElement.doScroll("left")}catch(e){return}bindReady()},500)}}}Jobs.regist=function(sJobName,oJobFunc){ready(oJobFunc,sJobName)}})();if(typeof App=="undefined"){var App={}}scope.loginKit=function(){var documentCookie=document.cookie+";";var supRegExp=["SUP","=([^;]*)?;"].join("");var uidRegExp=["(\\?|&)","uid","=([^&]*)(&|$)"].join("");var info=documentCookie.match(new RegExp(supRegExp,"i"));info=(info)?info[1]||"":"";info=unescape(info);var uid=info.match(new RegExp(uidRegExp));uid=(uid)?uid[2]||"":"";var oid=scope["$oid"];return{uid:uid,isLogin:!!uid,isAdmin:uid&&oid&&(uid==oid)}};scope.$isLogin=function(){return scope.loginKit().isLogin};scope.$isAdmin=function(){return scope.loginKit().isAdmin};Sina.pkg("Core");if(typeof Core=="undefined"){Core=Sina.Core}Sina.pkg("Core.String");Core.String.j2o=function(str){if(!str||str==""){return null}try{var o=window.eval("("+str+")");return o}catch(e){$Debug("j2o : 数据分析出错");traceError(e);return null}};Sina.pkg("Utils");if(typeof Utils=="undefined"){Utils=Sina.Utils}Sina.pkg("Utils.Io");Utils.Url=function(url){url=url||"";this.url=url;this.query={};this.parse()};Utils.Url.prototype={parse:function(url){if(url){this.url=url}this.parseAnchor();this.parseParam()},parseAnchor:function(){var anchor=this.url.match(/\#(.*)/);anchor=anchor?anchor[1]:null;this._anchor=anchor;if(anchor!=null){this.anchor=this.getNameValuePair(anchor);this.url=this.url.replace(/\#.*/,"")}},parseParam:function(){var query=this.url.match(/\?([^\?]*)/);query=query?query[1]:null;if(query!=null){this.url=this.url.replace(/\?([^\?]*)/,"");this.query=this.getNameValuePair(query)}},getNameValuePair:function(str){var o={};str.replace(/([^&=]*)(?:\=([^&]*))?/gim,function(w,n,v){if(n==""){return}o[n]=v||""});return o},getParam:function(sPara){return this.query[sPara]||""},clearParam:function(){this.query={}},setParam:function(name,value){if(name==null||name==""||typeof(name)!="string"){throw new Error("no param name set")}this.query=this.query||{};this.query[name]=value},setParams:function(o){this.query=o},serialize:function(o){var ar=[];for(var i in o){if(o[i]==null||o[i]==""){ar.push(i+"=")}else{ar.push(i+"="+o[i])}}return ar.join("&")},toString:function(){var queryStr=this.serialize(this.query);return this.url+(queryStr.length>0?"?"+queryStr:"")+(this.anchor?"#"+this.serialize(this.anchor):"")},getHashStr:function(forceSharp){return this.anchor?"#"+this.serialize(this.anchor):(forceSharp?"#":"")}};Core.String.encodeDoubleByte=function(str){if(typeof str!="string"){return str}return encodeURIComponent(str)};Sina.pkg("Core.Base");(function(){var Detect=function(){var ua=navigator.userAgent.toLowerCase();this.$IE=/msie/.test(ua);this.$OPERA=/opera/.test(ua);this.$MOZ=/gecko/.test(ua);this.$IE5=/msie 5 /.test(ua);this.$IE55=/msie 5.5/.test(ua);this.$IE6=/msie 6/.test(ua);this.$IE7=/msie 7/.test(ua);this.$SAFARI=/safari/.test(ua);this.$winXP=/windows nt 5.1/.test(ua);this.$winVista=/windows nt 6.0/.test(ua);this.$FF2=/Firefox\/2/i.test(ua);this.$IOS=/\((iPhone|iPad|iPod)/i.test(ua)};Core.Base.detect=new Detect()})();Utils.Io.Ajax={createRequest:function(){var request=null;try{request=new XMLHttpRequest()}catch(trymicrosoft){try{request=new ActiveXObject("Msxml2.XMLHTTP")}catch(othermicrosoft){try{request=ActiveXObject("Microsoft.XMLHTTP")}catch(failed){}}}if(request==null){$Debug.error("<b>create request failed</b>",{html:true})}else{return request}},request:function(url,option){option=option||{};option.onComplete=option.onComplete||function(){};option.onException=option.onException||function(){};option.returnType=option.returnType||"txt";option.method=option.method||"get";option.data=option.data||{};if(typeof option.GET!="undefined"&&typeof option.GET.url_random!="undefined"&&option.GET.url_random==0){this.rand=false;option.GET.url_random=null}this.loadData(url,option)},loadData:function(url,option){var request=this.createRequest(),tmpArr=[];var _url=new Utils.Url(url);if(option.POST){for(var postkey in option.POST){var postvalue=option.POST[postkey];if(postvalue!=null){tmpArr.push(postkey+"="+Core.String.encodeDoubleByte(postvalue))}}}var sParameter=tmpArr.join("&")||"";if(option.GET){for(var key in option.GET){if(key!="url_random"){_url.setParam(key,Core.String.encodeDoubleByte(option.GET[key]))}}}if(this.rand!=false){_url.setParam("rnd",Math.random())}request.onreadystatechange=function(){if(request.readyState==4){var response,type=option.returnType;try{switch(type){case"txt":response=request.responseText;break;case"xml":if(Core.Base.detect.$IE){response=request.responseXML}else{var Dparser=new DOMParser();response=Dparser.parseFromString(request.responseText,"text/xml")}break;case"json":response=eval("("+request.responseText+")");break}option.onComplete(response)}catch(e){option.onException(e.message,_url);return false}}};try{if(option.POST){request.open("POST",_url,true);request.setRequestHeader("Content-Type","application/x-www-form-urlencoded");request.send(sParameter)}else{request.open("GET",_url,true);request.send(null)}}catch(e){option.onException(e.message,_url);return false}}};App.doRequest=function(oData,sUrl,fCb,fEcb,ptype,type){var emptyFun=function(){};var param={onComplete:function(result){try{if(typeof result=="string"){result=result.replace(/;$/,"")}result=(typeof result=="string"&&(/\s*{/.test(result)))?Core.String.j2o(result):result;fCb(result)}catch(e){trace(e)}},onException:function(json){(fEcb||emptyFun)(json)}};ptype=(ptype||"post").toUpperCase();param[ptype]=oData;param.returnType="json";type=type||"ajax";Utils.Io.Ajax.request(sUrl,param)};var sysLang={zh_cn:{n001:"已关注",n002:"你已经关注",n003:"的微博",n004:"你自己",n005:"请重试",n006:"关注",n007:"点此开通新浪微博",n008:"你还未开通新浪微博,不能加关注"},zh_tw:{n001:"已關注",n002:"你已經關注",n003:"的微博",n004:"你自己",n005:"請重試",n006:"關注",n007:"點此開通新浪微博",n008:"你還未開通新浪微博,不能加關注"}},Lang;Jobs.regist("Language_init",function(){Lang=sysLang[scope.language?scope.language:"zh_cn"]});Jobs.regist("followBtn",function(){scope.postLogin=0;var button=$E("followBtn"),followTxt=$E("followTxt"),addButtonDiv=$E("addButton"),fansNum=$E("fansNum"),divCss=scope.btn==="red"?"r":"g";var loading=function(){button.className="add_att"+divCss+"_loading"},callback=function(json){if(json.code=="0"){return}var clss="add_att"+divCss+"_normal add_att"+divCss+"_normal_ok",txt=Lang.n001,title=Lang.n002+scope.uname+Lang.n003;if(json.code==="A00006"||json.code==="A00008"){if(fansNum&&scope.write==1&&!json.first){var fans=fansNum.innerHTML;fans=parseInt(fans)+1;fansNum.innerHTML=fans}button.href="//weibo.com/u/"+scope.uid;button.target="_blank";button.onclick=null}else{if(json.code==="A10007"||json.code==1||json.code==2){button.href="//weibo.com/u/"+scope.uid;button.target="_blank";button.onclick=null}else{if(json.code==="M00006"||json.code==3){button.href="//weibo.com/u/"+scope.uid;button.target="_blank";button.onclick=null;title=txt=Lang.n004}else{if(json.code==="M00005"){if(!json.firstAjax){clss="add_att"+divCss+"_normal";App.followBtnLogin();button.className=clss}return}else{if(!json.firstAjax){clss="add_att"+divCss+"_normal";txt=Lang.n005;title=Lang.n006+scope.uname+Lang.n003}}}}}button.className=clss;followTxt.innerHTML=txt;$E("followBtn").title=title},eCallback=function(){button.className="add_att"+divCss+"_normal";followTxt.innerHTML=Lang.n005};var url="http://"+location.host+"/relationship/aj_attention.php",isfansUrl="aj_isfans.php";if(/service/.test(location.host)){url="http://"+location.host+"/widget/relationship/aj_attention.php";isfansUrl="http://"+location.host+"/widget/relationship/aj_isfans.php"}App.reg2Back=function(){App.doFollow();try{App.loginPopWindow.close()}catch(e){}};(function(){this.entry="miniblog";this.service="miniblog";this.domain="weibo.com";this.appLoginURL["weibo.com"]="../../weibo.com/sso/login.php"}).call(sinaSSOController);sinaSSOController.autoLogin(function(){if(scope.$isLogin()){App.doRequest({uid:scope.uid},isfansUrl,function(json){json.firstAjax=1;callback(json)},function(){},"get")}});App.doFollow=function(){var data={refer:scope.refer||"",login:scope.postLogin,uid:scope.uid};loading();App.doRequest(data,url,callback,eCallback)};App.followBtn=function(){if(scope.$isLogin()){App.doFollow()}else{App.followBtnLogin()}};button.onclick=App.followBtn;(function(){var uid=scope.loginKit().uid;(new Image()).src="../../rs.sinajs.cn/b.gif@uid="+uid+"&refer="+encodeURIComponent(scope.refer)+"&rnd="+(new Date).getTime()})()});App.followBtnLogin=function(cbfun){App.loginBackUrlCallBack=function(){var uid=scope.loginKit().uid;(new Image()).src="../../rs.sinajs.cn/r.gif@uid="+uid+"&appid="+scope.appkey+"&rnd="+(+new Date());cbfun&&cbfun()};scope.postLogin=1;var lang=scope.language?scope.language:"zh_cn";var url="http://"+location.host+"/relationship/followlogin.php?uid="+scope.uid+"&refer="+scope.refer+"&language="+lang+"&rnd="+(new Date().valueOf());if(/service/.test(location.host)){url="http://"+location.host+"/widget/relationship/followlogin.php?uid="+scope.uid+"&refer="+scope.refer+"&language="+lang+"&rnd="+(new Date().valueOf())}if(scope.$spr){url+="&c="+scope.$spr}var loginPopWindow=window.open(url,"miniblog_login",["toolbar=0,status=0,resizable=1,width=620,height=540,left=",(screen.width-620)/2,",top=",(screen.height-450)/2].join(""));try{loginPopWindow.focus()}catch(e){}App.loginPopWindow=loginPopWindow};