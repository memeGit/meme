/*1328527779,169775812*/

if (window.CavalryLogger) { CavalryLogger.start_js(["gL+LP"]); }

XdArbiter={handleMessage:function(a){try{var c=JSON.parse(a);if(!c.method)return;Arbiter.inform('Connect.Unsafe.'+c.method,c.params,Arbiter.BEHAVIOR_PERSISTENT);}catch(b){}},_getNixProxy:function(){if(XdArbiter._getNixProxyDone)return;XdArbiter._getNixProxyDone=true;window.execScript('Class NixProxy\n'+'    Private m_parent\n'+'    Public Sub setParent(parent)\n'+'        If IsEmpty(m_parent) Then SET m_parent = parent\n'+'    End Sub\n'+'    Public Sub postMessage(msg)\n'+'        m_parent.postMessage(CStr(msg))\n'+'    End Sub\n'+'End Class\n'+'Function getNixProxy()\n'+'    Set GetNixProxy = New NixProxy\n'+'End Function\n','vbscript');return getNixProxy();},setupNixTransport:function(a){try{var c=XdArbiter._getNixProxy();c.setParent({postMessage:function(d){window.setTimeout(function(){XdArbiter.handleMessage(d);});}});a.contentWindow.opener=c;}catch(b){}}};if(window.postMessage)onloadRegister_DEPRECATED(function(){Event.listen(window,'message',function(a){XdArbiter.handleMessage(a.data);});});
PlatformAppController={BASE_CONFIG:{allowResizing:true,allowDialogs:true,disableUiServerMethods:[],maxHeight:null},_instanceConfig:{},init:function(a){var b=copy_properties(copy_properties({},PlatformAppController.BASE_CONFIG),a.config);PlatformAppController._instanceConfig[a.name]=copy_properties({client:b},a);XdArbiter.setupNixTransport($(a.name));if(!PlatformAppController._initDone){PlatformAppController._initDone=true;PlatformAppController.setupXdHandler('scrollTo');PlatformAppController.setupXdHandler('setSize');PlatformAppController.setupXdHandler('showDialog');PlatformAppController.setupXdHandler('getPageInfo');}},getFrameParams:function(a){return PlatformAppController._instanceConfig[a];},setupXdHandler:function(a){Arbiter.subscribe('Connect.Unsafe.'+a,function(b,c){var d=c.frame,e=PlatformAppController._instanceConfig[d];if(!e||!e.client)return;if(!ge(d))return;PlatformAppController[a](d,e.client,c);});},scrollTo:function(a,b,c){var d=parseInt(c.x,10),e=parseInt(c.y,10);if(d>=0&&e>=0)window.scrollTo(d,e);},setSize:function(a,b,c){if(!b.allowResizing)return;var d=parseInt(c.height,10);if(b.maxHeight&&d>b.maxHeight)d=b.maxHeight;CSS.setStyle($(a),'height',d+'px');},getPageInfo:function(a,b,c){if(!b.pageInfo)b.pageInfo={};PlatformCanvasResponse.getPageInfo($(a),b.pageInfo,c);},showDialog:function(a,b,c){if(!b.allowDialogs)return;Bootloader.loadComponents(['async','dialog'],function(){var d=c.params,e;if(d.method==='stream.share'){var f='message',g='self';e=new AsyncRequest().setMethod('GET').setReadOnly(true).setURI(URI('ajax/sharer/default.htm').setQueryData({appid:d.api_key,mode:d.mode==='message'?f:g,next:d.next,to:d.to,u:d.u}));}else{var h={oauth:'permissions.request',feed:'stream.publish'};if(d.method in h)d.method=h[d.method];e=new AsyncRequest().setMethod('GET').setReadOnly(true).setURI(URI('fbml/ajax/uiserver.php').setQueryData(d));}new Dialog().setAsync(e).setModal(true).setWideDialog(true).show().setCloseHandler(function(i){var j=d.next;if(i)j=j.replace(encodeURIComponent('"xxRESULTTOKENxx"'),encodeURIComponent(JSON.stringify(i)));XD.send({},j);});});}};