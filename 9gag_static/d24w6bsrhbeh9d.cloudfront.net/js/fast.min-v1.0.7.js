GAG={};GAG.Fast={isLoading:false,loadCount:0,buffer:3,fastFlipList:[],fastFlipIndex:0,loadMore:function(c,e,b){var a="read/"+c;if(GAG.Fast.isLoading){return}GAG.Fast.isLoading=true;var d=$.ajax({url:a,data:{id:e},success:function(g,f,h){$("#block-content").append(g);if(b){$("#load-"+c).click()}GAG.Fast.isLoading=false},error:function(){GAG.Fast.isLoading=false}})},renderFacebookElements:function(a){try{FB.XFBML.parse(document.getElementById("fb-like-"+a));FB.XFBML.parse(document.getElementById("fb-comments-"+a))}catch(b){GAG.Social.Facebook.bindFailureCb();return}},reloadAds:function(){if(this.loadCount%5==0){$("#ads-slot").attr("src","http://9gag.com/static/ads/fast-ads-300x250.html")}this.loadCount++},bindElements:function(){$(window.document).keydown(function(b){var a=b.keyCode;if(a==37||a==75){$("#load-prev").click()}else{if(a==39||a==74){$("#load-next").click()}}});window.lastTs=$time();$("a.fast-flip.prev-post").click(function(d){_gaq.push(["_trackEvent","Fast-Flip","Clicked","Prev",1]);_gaq.push(["_trackEvent","Fast-Flip-Interval","Clicked","Prev",getTs()]);rmt("../goo.gl/ahgvH@t="+((new Date()).getTime()));var f=GAG.Fast.fastFlipList[GAG.Fast.fastFlipIndex];var c=GAG.Fast.fastFlipList[0];var a=GAG.Fast.fastFlipIndex<=0;if(GAG.Fast.fastFlipIndex<=0+GAG.Fast.buffer){GAG.Fast.loadMore("prev",c,a)}if(!a){GAG.Fast.reloadAds();GAG.Fast.fastFlipIndex--;var b=GAG.Fast.fastFlipList[GAG.Fast.fastFlipIndex];$("#entry-"+f).hide();$("#entry-"+b).show();$(window.document).scrollTop(0);GAG.Fast.renderFacebookElements(b);window.location.href="#"+b}});$("a.fast-flip.next-post").click(function(d){_gaq.push(["_trackEvent","Fast-Flip","Clicked","Next",1]);_gaq.push(["_trackEvent","Fast-Flip-Interval","Clicked","Next",getTs()]);rmt("../goo.gl/B7hcq@t="+((new Date()).getTime()));var f=GAG.Fast.fastFlipList[GAG.Fast.fastFlipIndex];var a=GAG.Fast.fastFlipList[GAG.Fast.fastFlipList.length-1];var b=GAG.Fast.fastFlipIndex>=GAG.Fast.fastFlipList.length-1;if(GAG.Fast.fastFlipIndex>=GAG.Fast.fastFlipList.length-1-GAG.Fast.buffer){GAG.Fast.loadMore("next",a,b)}if(!b){GAG.Fast.reloadAds();GAG.Fast.fastFlipIndex++;var c=GAG.Fast.fastFlipList[GAG.Fast.fastFlipIndex];$("#entry-"+f).hide();$("#entry-"+c).show();$(window.document).scrollTop(0);GAG.Fast.renderFacebookElements(c);window.location.href="#"+c}});$("#close").click(function(a){_gaq.push(["_trackEvent","Fast-Flip","Clicked","Close",1]);var b=GAG.Fast.fastFlipList[GAG.Fast.fastFlipIndex];window.location.href="gag/"+b})}};GAG.Social={};GAG.Social.Facebook={appId:null,INIT_FAILURE_MESSAGE:"Facebook Connect is not enabled, please check if there's any browser plugin blocking the function.",init:function(){var a=$("fb-app-id");if(!a){return}this.appId=a.get("value");this.bindEvents()},bindFailureCb:function(){$(".facebook-init-failed").text(this.INIT_FAILURE_MESSAGE).show()},bindEvents:function(){try{if(!FB||!FB.init){this.bindFailureCb();return}}catch(a){this.bindFailureCb();return}FB.init({appId:this.appId,status:true,cookie:true,xfbml:true,oauth:true});FB.Event.subscribe("edge.create",function(c,f,b){var d=f.dom;var e=$(d).attr("label");if(!e||e.length==0){e="Default"}_gaq.push(["_trackEvent","Facebook-Like-Button",e+"Liked",c,1])});FB.Event.subscribe("edge.remove",function(b,e){var c=e.dom;var d=$(c).attr("label");if(!d||d.length==0){d="Default"}_gaq.push(["_trackEvent","Facebook-Like-Button",d+"RemovedLike",b,1])});FB.Event.subscribe("comment.create",function(d,c){var b=d.href;_gaq.push(["_trackEvent","Facebook-Comment","FastCommentAdded",b,1])});FB.Event.subscribe("comment.remove",function(d,c){var b=d.href;_gaq.push(["_trackEvent","Facebook-Comment","FastCommentRemoved",b,1])})},bindElements:function(){}};function $time(){return(new Date()).getTime()}function getTs(){var b=$time();var a=b-window.lastTs;window.lastTs=b;return Math.min(a,60000)}$(function(){GAG.Fast.bindElements();GAG.Fast.loadMore("first",window.location.hash);GAG.Social.Facebook.init();GAG.Fast.reloadAds()});