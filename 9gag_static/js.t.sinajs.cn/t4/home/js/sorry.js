STK.register("common.listener",function(b){var c={};var a={};a.define=function(e,f){if(c[e]!=null){throw"common.listener.define: 频道已被占用"}c[e]=f;var d={};d.register=function(h,g){if(c[e]==null){throw"common.listener.define: 频道未定义"}b.listener.register(e,h,g)};d.fire=function(g,h){if(c[e]==null){throw"commonlistener.define: 频道未定义"}b.listener.fire(e,g,h)};d.remove=function(h,g){b.listener.remove(e,h,g)};d.cache=function(g){return b.listener.cache(e,g)};return d};return a});STK.register("common.channel.topTip",function(b){var a=["refresh","readed"];return b.common.listener.define("common.channel.topTip",a)});STK.register("kit.extra.merge",function(a){return function(d,c){var f={};for(var e in d){f[e]=d[e]}for(var e in c){f[e]=c[e]}return f}});STK.register("kit.io.ajax",function(b){var a=function(d,e,f){e=(e|0)||1;f=f||"fail";var c=d.args;if(c.__rnd){delete c.__rnd}(new Image()).src="../weibolog.sinaapp.com/@t="+e+"&u="+encodeURIComponent(d.url)+"&p="+encodeURIComponent(b.core.json.jsonToQuery(c))+"&m="+f};return function(j){var i,g,f,h,k,c,d;c=function(m){k=false;j.onComplete(m,i.args);setTimeout(l,0)};d=function(m){k=false;if(typeof j.onFail==="function"){j.onFail(m,i.args)}setTimeout(l,0);try{a(i)}catch(n){}};f=[];h=null;k=false;i=b.parseParam({url:"",method:"get",responseType:"json",timeout:30*1000,onTraning:b.funcEmpty,isEncode:true},j);i.onComplete=c;i.onFail=d;i.onTimeout=function(){try{a(i)}catch(m){}};var l=function(){if(!f.length){return}if(k===true){return}k=true;i.args=f.shift();if(i.method.toLowerCase()=="post"){var m=b.core.util.URL(i.url);m.setParam("__rnd",new Date().valueOf());i.url=m.toString()}h=b.ajax(i)};var e=function(n){while(f.length){f.shift()}k=false;if(h){try{h.abort()}catch(m){}}h=null};g={};g.request=function(m){if(!m){m={}}if(j.noQueue){e()}if(!j.uniqueRequest||!h){f.push(m);m._t=0;l()}};g.abort=e;return g}});STK.register("kit.io.jsonp",function(a){return function(d){var c,f,b,h,e;c=a.parseParam({url:"",method:"get",responseType:"json",varkey:"_v",timeout:30*1000,onComplete:a.funcEmpty,onTraning:a.funcEmpty,onFail:a.funcEmpty,isEncode:true},d);b=[];h={};e=false;var g=function(){if(!b.length){return}if(e===true){return}e=true;h.args=b.shift();h.onComplete=function(i){e=false;c.onComplete(i,h.args);setTimeout(g,0)};h.onFail=function(i){e=false;c.onFail(i);setTimeout(g,0)};a.jsonp(a.kit.extra.merge(c,{args:h.args,onComplete:function(i){h.onComplete(i)},onFail:function(i){try{h.onFail(i)}catch(j){}}}))};f={};f.request=function(i){if(!i){i={}}b.push(i);i._t=1;g()};f.abort=function(i){while(b.length){b.shift()}e=false;h=null};return f}});STK.register("kit.io.inter",function(a){return function(){var b,d,c;b={};d={};c={};b.register=function(f,e){if(d[f]!==undefined){throw f+" interface has been registered"}d[f]=e;c[f]={}};b.hookComplete=function(e,g){var f=a.core.util.getUniqueKey();c[e][f]=g;return f};b.removeHook=function(e,f){if(c[e]&&c[e][f]){delete c[e][f]}};b.getTrans=function(g,e){var f=a.kit.extra.merge(d[g],e);f.onComplete=function(i,l){try{e.onComplete(i,l)}catch(j){}if(i.code==="100000"){try{e.onSuccess(i,l)}catch(j){}}else{try{if(i.code==="100002"){window.location.href=i.data;return}e.onError(i,l)}catch(j){}}for(var h in c[g]){try{c[g][h](i,l)}catch(j){}}};if(d[g]["requestMode"]==="jsonp"){return a.kit.io.jsonp(f)}else{if(d[g]["requestMode"]==="ijax"){return a.kit.io.ijax(f)}else{return a.kit.io.ajax(f)}}};b.request=function(h,e,g){var f=a.core.json.merge(d[h],e);f.onComplete=function(j,m){try{e.onComplete(j,m)}catch(l){}if(j.code==="100000"){try{e.onSuccess(j,m)}catch(l){}}else{try{if(j.code==="100002"){window.location.href=j.data;return}e.onError(j,m)}catch(l){}}for(var i in c[h]){try{c[h][i](j,m)}catch(l){}}};f=a.core.obj.cut(f,["noqueue"]);f.args=g;if(d[h]["requestMode"]==="jsonp"){return a.jsonp(f)}else{if(d[h]["requestMode"]==="ijax"){return a.ijax(f)}else{return a.ajax(f)}}};return b}});STK.register("common.trans.top",function(d){var a=d.kit.io.inter();var b=a.register;var c=(document.domain=="127.0.0.1"?"./":"../weibo.com/");b("suggest",{url:"../s.weibo.com/ajax/topsuggest.php",requestMode:"jsonp",method:"get"});b("setRead",{url:c+"/aj/remind/reset",requestMode:"jsonp",method:"get"});b("application",{url:c+"/aj/top/myapp",requestMode:"jsonp",method:"get"});b("group",{url:c+"/aj/top/myqun",requestMode:"jsonp",method:"get"});b("game",{url:c+"/aj/top/game",requestMode:"jsonp",method:"get"});return a});STK.register("kit.dom.parseDOM",function(a){return function(c){for(var b in c){if(c[b]&&(c[b].length==1)){c[b]=c[b][0]}}return c}});STK.register("kit.dom.hover",function(a){return function(o){var g=o.delay||100;var n=o.isover||false;var l=o.act;var e=o.extra||[];var c=null;var d=function(i){if(n){o.onmouseover.apply(l,[i])}};var h=function(i){if(!n){o.onmouseout.apply(l,[i])}};var m=function(i){n=true;if(c){clearTimeout(c)}c=setTimeout(function(){d(i)},g)};var b=function(i){n=false;if(c){clearTimeout(c)}c=setTimeout(function(){h(i)},g)};a.core.evt.addEvent(l,"mouseover",m);a.core.evt.addEvent(l,"mouseout",b);for(var f=0,k=e.length;f<k;f+=1){a.core.evt.addEvent(e[f],"mouseover",m);a.core.evt.addEvent(e[f],"mouseout",b)}var j={};j.destroy=function(){a.core.evt.removeEvent(l,"mouseover",m);a.core.evt.removeEvent(l,"mouseout",b);for(var q=0,p=e.length;q<p;q+=1){a.core.evt.removeEvent(e[q],"mouseover",m);a.core.evt.removeEvent(e[q],"mouseout",b)}};return j}});STK.register("common.extra.toplang",function(){return{"首页":"首頁","应用":"應用","浏览热门应用":"浏覽熱門應用","管理/查看更多应用":"管理/查看更多應用","查看我的游戏":"查看我的遊戲","游戏":"遊戲","帐号":"帳號","帐号设置":"帳號設置","版本选择":"版本選擇","工具设置":"工具設置","我的微币":"我的微幣","还没有微博帐号？":"還沒有微博帳號？","注册":"注冊","登录":"登錄","相关微博":"相關微博","相关用户":"相關用戶","粉丝":"粉絲","相关微群":"相關微群","群号":"群號","成员":"成員","相关应用":"相關應用","你还没有加入任何微群，现在就去":"你還沒有加入任何微群，現在就去","发现微群":"發現微群","热门微群推荐":"熱門微群推薦","条新评论":"條新評論","查看评论":"查看評論","位新粉丝":"位新粉絲","查看粉丝":"查看粉絲","条新私信":"條新私信","条新@提到我":"條新@提到我","条群内新消息":"條群內新消息","条相册新消息":"條相冊新消息","条新通知":"條新通知","条新邀请":"條新邀請","查看邀请":"查看邀請","查看群内消息":"查看群內消息","查看相册消息":"查看相冊消息","_25E8_25BF_2598_25E6_25B2_25A1_25E6_259C_2589_25E6_2594_25B6_25E5_2588_25B0_25E7_25A7_2581_25E4_25BF07CECAC23B":"_25E9_2582_2584_25E6_25B2_2592_25E6_259C_2589_25E6_2594_25B6_25E5_2588_25B0_25E7_25A7_2581_25E4_25BF06B35C42C5","正在加载,请稍候...":"正在加載,請稍候...","模板设置":"模板設置","广场":"廣場","用户":"用戶","浏览热门游戏":"瀏覽熱門遊戲","常用游戏":"常用遊戲","你还没有玩过任何游戏，现在就去":"你還沒有玩過任何遊戲，現在就去","体验一下":"體驗一下","风云榜":"風雲榜","微话题":"微話題","微博精选":"微博精選","随便看看":"隨便看看","微访谈":"微訪談","查看更多有趣内容":"查看更多有趣內容","微博达人":"微博達人","我的微号":"我的微號","手机":"手機"}});STK.register("common.dialog.loginLayer",function(c){var d="../tjs.sjs.sinajs.cn/t4/",a;var b=d+"home/js/public/topLogin.js";return function(e){e=c.core.obj.parseParam({lang:"zh-cn",loginSuccessUrl:window.location.href},e);e.loginSuccessUrl="http://weibo.com/login.php?url="+e.loginSuccessUrl;if(window.WBtopPublicLogin){WBtopPublicLogin.showLoginLayer(e)}else{if(a){return}else{a=true;c.core.io.scriptLoader({url:b,onComplete:function(){a=false;window.WBtopPublicLogin.showLoginLayer(e)},timeout:10000,onTimeout:function(){a=false}})}}}});STK.register("comp.content.top",function(K){var k=(window.$CONFIG&&window.$CONFIG.any)||"";var b=k?"?&topnav=1&topsug=1":"?&topsug=1";var v="../q.weibo.com/",J="../s.weibo.com/",af="http://"+(document.domain=="127.0.0.1"?"www.weibo.com":"weibo.com"),q="../img.t.sinajs.cn/t4/default.htm",A="../q.weibo.com/",aa="../rm.api.weibo.com/remind/unread_count.json@source=3818214747&target=api",ai=J+"weibo/default.htm",t=J+"user/default.htm",ab=J+"q/default.htm",W=J+"apps/default.htm",ae='<#et suggest data><div class="selectbox"><p action-type="select" isStatic="1" durl="'+ai+"${data.keywordlong}"+b+'" class="title current">搜 “<span class="c_red">${data.keyword}</span>” #L{相关微博}»</p></div><div class="selectbox"><p action-type="select" class="title" isStatic="1" durl="'+t+"${data.keywordlong}"+b+'">搜 “<span class="c_red">${data.keyword}</span>” #L{相关用户}»</p></div></#et>',X='<#et suggest data><div class="selectbox"><p action-type="select" isStatic="1" durl="'+ai+"${data.keywordlong}"+b+'" class="title current">搜 “<span class="c_red">${data.keyword}</span>” #L{相关微博}»</p><#list data.querys as list><p class="keyword" action-type="select" suda-data="key=${list.sudaKey}&value=${list.sudaValue}" durl="'+ai+"${list.ekey}"+b+'">${list.key}</p></#list></div><div class="selectbox"><p action-type="select" class="title" isStatic="1" durl="'+t+"${data.keywordlong}"+b+'">搜 “<span class="c_red">${data.keyword}</span>” #L{相关用户}»</p><#if (data.userlist.length)><div node-type="userResult"><#list data.userlist as list><dl class="clearfix" action-type="select" suda-data="key=${list.sudaKey}&value=${list.sudaValue}" durl="'+af+"/u/${list.u_id}"+b+'"><dt><img height="30" width="30" src="${list.u_pic}"></dt><dd><span><!--start-->${list.u_name}<!--end--><#if (list.is_v)><img class="<#if (list.verified_type)> approve_co<#else> approve</#if>" alt="" src="${data.imgPath}style/images/common/transparent.gif"></#if><#if (list.verified_type == 220)><img class="ico_club" alt="#L{微博达人}" title="#L{微博达人}" src="../img.t.sinajs.cn/t4/style/images/common/transparent.gif"></#if></span><p class="area txtb"><span class="${list.sex=="m"?"male":"female"}"></span> <!--start-->#L{粉丝}:${list.fans_n} _3C#if (list.prov)>${list.prov}</#if><!--end--></p></dd></dl></#list></div></#if></div></#et>',I='<#et suggest data><#if (data.weiqun)><div class="selectbox"><p action-type="select" class="title" isStatic="1" durl="'+ab+"${data.keywordlong}"+b+'">搜 “<span class="c_red">${data.keyword}</span>” #L{相关微群}»</p><div node-type="weiqunResult"><dl class="clearfix" action-type="select" suda-data="key=tblog_top_search_v4&value=weiqunc" durl="'+v+"/${data.weiqun.id}"+b+'"><dt><span><img height="30" width="30" src="${data.weiqun.pic}"></span></dt><dd><span><!--start-->${data.weiqun.name}<!--end--><span class="${data.weiqun.grade}"></span></span><p class="txtb member">#L{成员}:${data.weiqun.members}</p></dd></dl></div></div></#if><#if (data.app)><div class="selectbox"><p action-type="select" class="title" isStatic="1" durl="'+W+"${data.keywordlong}"+b+'">搜 “<span class="c_red">${data.keyword}</span>” #L{相关应用}»</p><div node-type="appResult"><dl class="clearfix" action-type="select" suda-data="key=tblog_top_search_v4&value=appc" durl="${data.app.link}'+b+'"><dt><span><img height="30" width="30" src="${data.app.pic}"></span></dt><dd><span><!--start-->${data.app.name}<!--end--></span><p class="txtb">#L{用户}:${data.app.owner_n}</p></dd></dl></div></div></#if></#et>',Z='<#et app data><#if (data.offical_app)><ul class="app_list"><#list data.offical_app as list><li><a href="${list.link}" title="${list.name}" target="_top"><img height="16" width="16" alt="${list.name}" src="${list.icon}">${list.sname}</a></li></#list></ul></#if><#if (data.my_app)><div class="recent_app_list"><div class="app_title clearfix"><p><a target="_top" title="#L{管理应用}" href="../account.weibo.com/settings/connections">#L{管理应用}</a><em class="W_vline">|</em><a target="_top" title="#L{浏览更多}" href="'+af+'/app?topnav=1">#L{浏览更多}</a></p><h3>#L{${(data.my_app[0].category_id=="3")? "最近使用":"推荐应用"}}</h3></div><ul><#list data.my_app as list><li><div><a target="_top" href="${list.link}" title="${list.name}" class="app_pic_bg"></a><img style="width: 50px; height: 50px;" alt="${list.name}" src="${list.icon}" class="app_img"></div><a target="_top" class="app_name" href="${list.link}">${list.sname}</a><p>${(list.category_id=="4")?"<em></em>":list.time}</p></li></#list></ul></div></#if></#et>',s='<#et game data><div class="border clearfix"><ul class="game_recommend clearfix"><#list data.suggest as list><li><a target="_top" href="${list.game_url}" title="${list.description}"><img width="100" height="50" src="${list.thumbnail}" />${list.name}</a></li></#list></ul></div><div class="border clearfix"><#if (data.my.length)><ul class="yy_list"><#list data.my as list><li><a target="_top" href="${list.game_url}"><img width="16" height="16" src="${list.icon}" />${list.name}</a></li></#list></ul><#if (data.myB)><ul class="yy_list"><#list data.myB as list><li><a target="_top" href="${list.game_url}"><img width="16" height="16" src="${list.icon}" />${list.name}</a></li></#list></ul></#if><#else><div class="zero">#L{你还没有玩过任何游戏，现在就去}<a target="_top" href="../game.weibo.com/@origin=1021&topnav=1_2F'+k+'">#L{体验一下}</a>#L{吧}!</div></#if></div></#et>',x='<#et plaza data><div class="border clearfix"><ul class="yy_list group_list"><li><a target="_top" href="../verified.weibo.com/@topnav=1_2F'+k+'"><img width="16" height="16" alt="#L{名人堂}" src="${data.imgPath}style/images/common/ico_fame.gif">#L{名人堂}</a></li><li><a target="_top" href="../club.weibo.com/@topnav=1_2F'+k+'"><img width="16" height="16" alt="#L{微博达人}" src="${data.imgPath}style/images/common/ico_talstat.png">#L{微博达人}</a></li><li><a target="_top" href="../data.weibo.com/top@topnav=1"><img width="16" height="16" alt="#L{风云榜}" src="${data.imgPath}style/images/common/ico_toplistof.gif">#L{风云榜}</a></li><li><a target="_top" href="'+af+"/pub/topic?topnav=1"+k+'"><img width="16" height="16" alt="#L{微话题}" src="${data.imgPath}style/images/common/ico_topic.gif">#L{微话题}</a></li><li><a target="_top" href="'+af+"/jx/pic.php?topnav=1"+k+'"><img width="16" height="16" alt="#L{微博精选}" src="${data.imgPath}style/images/common/ico_handpick.png">#L{微博精选}</a></li><li><a target="_top" href="'+af+"/pub/news?topnav=1"+k+'"><img width="16" height="16" alt="#L{随便看看}" src="${data.imgPath}style/images/common/ico_browsing.png">#L{随便看看}</a></li><li><a target="_top" href="'+af+"/pub/city?source=toptray"+k+'"><img width="16" height="16" alt="#L{同城微博}" src="${data.imgPath}style/images/common/ico_city.png">#L{同城微博}</a></li><li><a target="_top" href="../talk.weibo.com/@topnav=1'+k+'"><img width="16" height="16" alt="#L{微访谈}" src="${data.imgPath}style/images/common/ico_interview.gif">#L{微访谈}</a></li><li><a target="_top" href="../live.weibo.com/@topnav=1'+k+'"><img width="16" height="16" alt="#L{微直播}" src="${data.imgPath}style/images/common/ico_microlive.gif">#L{微直播}</a></li><li><a target="_top" href="../screen.weibo.com/@topnav=1'+k+'"><img width="16" height="16" alt="#L{大屏幕}" src="${data.imgPath}style/images/common/ico_screen.png">#L{大屏幕}</a></li><li><a target="_top" href="'+af+"/pub/topmblog?type=re&act=day&topnav=1&wvr=4"+k+'"><img width="16" height="16" alt="#L{热门微博}" src="${data.imgPath}style/images/common/ico_hot_fw.gif" >#L{热门微博}</a></li></ul></div></#et>',B='<#et group data><#if (data.my)><div class="border clearfix"><ul class="yy_list group_list"><#list data.my as list><li><#if (list.g_new!="0")><span class="W_count"><span>${list.g_new}</span></span></#if><a target="_top" href="'+v+'/${list.gid}?topnav=1"><img width="16" height="16" alt="${list.g_name}" src="${list.g_logo}">${list.g_name}</a></li></#list></ul><#if (data.myB)><ul class="yy_list group_list"><#list data.myB as list><li><#if (list.g_new!="0")><span class="W_count"><span>${list.g_new}</span></span></#if><a target="_top" href="'+v+'/${list.gid}?topnav=1"><img width="16" height="16" alt="${list.g_name}" src="${list.g_logo}">${list.g_name}</a></li></#list></ul></#if></div><#else><div class="border"><div class="zero">#L{你还没有加入任何微群，现在就去}<a target="_top" href="'+A+"?topnav=1"+k+'">#L{发现微群}</a>#L{吧}!</div></div><#if (data.suggest&&data.suggest.length)><table cellspacing="0" cellpadding="0" border="0" class="layer_title"><thead><tr><td class="line">&nbsp;</td><td nowrap="">&nbsp;#L{热门微群推荐}&nbsp;</td><td class="line">&nbsp;</td></tr></thead></table><div class="border clearfix"><ul class="yy_list group_list"><#list data.suggest as list><li><a target="_top" href="'+v+'/${list.gid}"><img width="16" height="16" alt="${list.g_name}" src="${list.g_logo}">${list.g_name}</a></li></#list></ul><#if (data.suggestB)><ul class="yy_list group_list"><#list data.suggestB as list><li><a target="_top" href="'+v+'/${list.gid}"><img width="16" height="16" alt="${list.g_name}" src="${list.g_logo}">${list.g_name}</a></li></#list></ul></#if></div></#if></#if></#et>',T='<#et tip data><#if (data.comment)><li${data.isNotice}>${data.comment}#L{条新评论}， <a target="_top" action-type="bp-link" bpfilter="main" href="'+af+"/comment/inbox?f=1&topnav=1"+k+'">#L{查看评论}</a></li></#if><#if (data.attention)><li${data.isNotice}>${data.attention}#L{位新粉丝}， <a target="_top" href="'+af+"/${data.userId}/fans?topnav=1"+k+'">#L{查看粉丝}</a></li></#if><#if (data.msg)><li${data.isNotice}>${data.msg}#L{条新私信}， <a target="_top" action-type="bp-link" action-data="goMsg=stop" bpfilter="main" href="'+af+"/messages?topnav=1"+k+'">#L{查看私信}</a></li></#if><#if (data.atme)><li${data.isNotice}>${data.atme}#L{条新@提到我}， <a target="_top" action-type="bp-link" bpfilter="main" href="${data.atlink}@topnav=1'+k+'">#L{查看@我}</a></li></#if><#if (data.group)><li${data.isNotice}>${data.group}#L{条群内新消息}， <a target="_top" href="'+v+"/message/proxJump.php?topnav=1"+k+'">#L{查看消息}</a></li></#if><#if (data.photo)><li${data.isNotice}>${data.photo}#L{条相册新消息}， <a target="_top" href="../photo.weibo.com/messages/index@topnav=1'+k+'">#L{查看消息}</a></li></#if><#if (data.notice)><li${data.isNotice}>${data.notice}#L{条新通知}， <a target="_top" href="'+af+"/systemnotice?topnav=1"+k+'">#L{查看通知}</a></li></#if><#if (data.invite)><li${data.isNotice}>${data.invite}#L{条新邀请}， <a target="_top" href="'+af+"/invite/recv.php?topnav=1"+k+'">#L{查看邀请}</a></li></#if></#et>',P='<#et tip data><#if (data.showTip)><li class="line"></li></#if><#if (data.comment)><li><a target="_top" action-type="bp-link" action-data="hide=true" bpfilter="main" href="'+af+"/comment/inbox?f=1&topnav=1"+k+'">#L{查看评论}</a></li></#if><#if (data.attention)><li><a target="_top" href="'+af+"/${data.userId}/fans?topnav=1"+k+'">#L{查看粉丝}</a></li></#if><#if (data.msg)><li><a target="_top" action-type="bp-link" action-data="hide=true" bpfilter="main" href="'+af+"/messages?topnav=1"+k+'">#L{查看私信}</a></li></#if><#if (data.atme)><li><a target="_top" action-type="bp-link" action-data="hide=true" bpfilter="main" href="'+af+"/at/weibo?topnav=1"+k+'">#L{查看@我}</a></li></#if><#if (data.group)><li><a target="_top" href="'+v+"/message/proxJump.php?topnav=1"+k+'">#L{查看群内消息}</a></li></#if><#if (data.photo)><li><a target="_top" href="../photo.weibo.com/messages/index@topnav=1'+k+'">#L{查看相册消息}</a></li></#if><#if (data.notice)><li><a target="_top" href="'+af+"/systemnotice?topnav=1"+k+'">#L{查看通知}</a></li></#if><#if (data.invite)><li><a target="_top" href="'+af+"/invite/recv.php?topnav=1"+k+'">#L{查看邀请}</a></li></#if></#et>',N="<#et notice data><ul>${data.newMsg}${data.linkMsg}</ul></#et>";var y='<div class="W_loading"><span>#L{正在加载,请稍候...}</span></div>',S="#L{搜索微博、找人}",M=30*1000,j=10*1000,aj=0.3*1000;var i=K.core.evt.addEvent,p=K.core.evt.removeEvent,ad=K.core.evt.stopEvent,L=K.core.evt.preventDefault,ag=K.core.evt.fixEvent,w=K.core.evt.delegatedEvent,a=K.core.str.trim,R=function(an){var am=document.createTextNode(an);var ao=K.C("div");ao.appendChild(am);var al=ao.innerHTML;ao=am=null;return al},F=K.core.str.leftB,D=K.core.arr.isArray,ah=K.core.arr.indexOf,e=K.core.util.language,c=K.core.util.browser,d=K.core.util.easyTemplate,H=K.core.util.getUniqueKey,m=K.core.dom.sizzle,E=K.core.dom.builder,h=K.core.dom.isNode,G=K.core.dom.contains,U=K.core.dom.position,V=K.core.dom.hasClassName,C=K.core.dom.addClassName,r=K.core.dom.removeClassName,Y=K.core.obj.parseParam,n=K.core.io.jsonp,Q=K.common.trans.top.getTrans,O=K.common.channel.topTip,o=K.kit.dom.hover;var f,g,l,z,ak,u;var ac=function(){function al(){this.subscribers={}}al.prototype={publish:function(ap,ar){this.subscribers[ap]=this.subscribers[ap]||[];for(var aq=0;aq<this.subscribers[ap].length;aq++){var an=this.subscribers[ap][aq];if(typeof an==="function"){var at=[];for(var ao=1,am=arguments.length;ao<am;ao++){at.push(arguments[ao])}an.apply(this,at)}}},subscribe:function(am,ao,an){this.subscribers[am]=this.subscribers[am]||[];this.subscribers[am].push(function(){ao.apply(an,arguments)})}};window.__PubSub__=window.__PubSub__||new al()};return function(aP,aL){var aQ,aV,aO,aM,aM,an,ap,aI,at,aS={},au=0,aU=0,av={},aC={},aN={},aD={},am,aA,aR=window.$CONFIG&&window.$CONFIG.$webim==1,ao,aw,aE=1,aF=0,aJ,aT;var aW={suggestUserFun:function(a4,a5){var a1=a5.key;if(a4.key==aM){if(typeof aC[a1]==="undefined"){aC[a1]={}}aC[a1]["userlist"]=a4.data.user;var a0;!a4.data.querys&&(a4.data.querys=[]);if(a4.data.querys){var a3='<span class="c_red">',aZ="</span>";for(var a2=0;a2<a4.data.querys.length;a2++){a0=a4.data.querys[a2].key;a4.data.querys[a2]["ekey"]=encodeURIComponent(a0);a4.data.querys[a2]["key"]=a0.replace(new RegExp(a1,"g"),a3+a1+aZ)}}a0=a2=null;aC[a1]["querys"]=a4.data.querys;ax.rendBasic(aC[a1],a1)}},suggestPlusFun:function(a3,a4){var a1=a4.key;if(a3.key==aM){if(typeof aC[a1]==="undefined"){aC[a1]={}}var aZ=false,a2;for(var a0 in a3.data){a2=a3.data[a0];aC[a1][a0]=a2;if(a2!==null){aZ=true}}if(!aZ){aC[a1]["noPlusResult"]=true}ax.rendPlus(aC[a1],a1)}},suggestUser:Q("suggest",{onComplete:function(aZ,a0){aW.suggestUserFun(aZ,a0);aW.suggestPlusFun(aZ,a0)},onSuccess:function(){},onError:function(){}}),cleanTipsNumber:Q("setRead",{onComplete:function(){},onSuccess:function(){},onError:function(){}}),getTrans:function(aZ){return Q(aZ,{onComplete:function(){},onSuccess:function(a0){aN[aZ]=false;aI[aZ]["cb"](a0.data)},onError:function(){aN[aZ]=false}})}};var ar={wordFilter:function(aZ){return encodeURIComponent(encodeURIComponent(aZ))},setBasicSudaData:function(a3,a0){if(a0&&D(a0)){var a1="tblog_top_search_v4";for(var a2=0,aZ=a0.length;a2<aZ;a2++){a0[a2].sudaKey=a1;a0[a2].sudaValue=a3+(a2+1)+"c"}}},webimStarted:function(){ao=1;aE=1;clearTimeout(aw)},webimShowMsg:function(aZ){aF=parseInt(aZ,10);av.msg=aF;ar.rendTips(av,true)},showLoginLayer:function(aZ){K.common.dialog.loginLayer(aZ)},adjustTopPos:function(){clearTimeout(at);at=setTimeout(ar.adjustTopPosImpl,100)},adjustTopPosImpl:function(){var aZ=K.core.util.scrollPos().top,a0;if(aZ>(aD.topHeight-2)){a0=aZ}else{a0=aD.topHeight-2}aV.tipsLayer.style.top=a0+"px"},isVisible:function(aZ){return aZ&&aZ.offsetWidth&&aZ.offsetHeight},getNewJson:function(a2){var a0={};var a4=[["feed","status"],["attention","follower"],["comment","cmt"],["msg","dm"],["atme","mention_status"],["atcmt","mention_cmt"],["group","group"],["notice","notice"],["invite","invite"],["badge","badge"],["photo","photo"]];var aZ=a4.length,a3;for(var a1=0;a1<aZ;a1++){a3=a4[a1];a0[a3[0]]=a2[a3[1]]}return a0},sendRequest:function(){n({url:aa+"&user_id="+f+"&_pid="+ap.pid+"&count="+au,onComplete:function(aZ){au++;if(aZ.code=="A00006"){aZ.data=ar.getNewJson(aZ.data);ar.rendTips(aZ.data);av=aZ.data;O.fire("refresh",av)}},onFail:function(){},onTimeout:function(){}})},getLayerData:function(aZ){if(aZ!="plaza"){var a0=["game","group","application"];aW.getTrans(aZ).request();if(ah(aZ,a0)>=0){setTimeout(function(){aN[aZ]=true},j)}}else{aV.plazaContent.innerHTML=d(e(x,u),{imgPath:ak})}},getSearchSuggest:function(aZ){ax.rendStatic(aZ);ax.suggestShow();if(typeof aC[aZ]!=="undefined"){ax.rendBasic(aC[aZ],aZ);if(!aC[aZ]["noPlusResult"]&&!(aC[aZ]["app"]||aC[aZ]["weiqun"])){}else{ax.rendPlus(aC[aZ],aZ)}}else{aM=H();aW.suggestUser.request({key:aZ,_k:aM,uid:f})}},replaceWeiqunClass:function(aZ){if(!aZ){return}if(typeof aZ.grade!=="undefined"){aZ.grade="mg_rankicon"+(parseInt(aZ.grade)<10?("0"+aZ.grade):aZ.grade)}return aZ},getTipsResult:function(a2,aZ,a9,a8){var ba={};var a6=["comment","attention","msg","atme","group","notice","invite","photo"],a1;for(var a3=0;a3<a6.length;a3++){if(a1=a1||a2[a6[a3]]){break}}ba.showTip=a1;if(a1){var a0=[];var a7=[];for(var a3=0;a3<a6.length;a3++){var a4=a6[a3];if(a2[a4]){a0.push(a4)}else{a7.push(a4)}}ba.newMsg=a0;ba.linkMsg=a7;try{window.external.msSiteModeSetIconOverlay("../img.t.sinajs.cn/t4/style/images/common/favicon/newMsg.ico","新消息")}catch(a5){}}else{ba.newMsg=[];ba.linkMsg=a6;try{window.external.msSiteModeClearIconOverlay()}catch(a5){}}ba.newMsg=ar.arrToObj(ba.newMsg,a2);ba.linkMsg=ar.arrToObj(ba.linkMsg,a2,true);ba.linkMsg.userId=f;ba.linkMsg.atlink=((a9==0&&a8!=0)?(af+"/at/comment"):(af+"/at/weibo"));return ba},arrToObj:function(a4,a2,a1){var a3={};for(var a0=0;a0<a4.length;a0++){var aZ=a4[a0];if(a1){a3[aZ]=1}else{a3[aZ]=a2[aZ]}}return a3},tipsCompareIsNew:function(a0,aZ){return ar.compareObjEquals(a0,aZ)},compareObjEquals:function(a4,a3){a4=a4||{};a3=a3||{};var a2=0,a0=0;for(var a1 in a4){a2++}for(var a1 in a3){a0++}if(a2!=a0){return true}var aZ=false;for(var a1 in a4){if(a4[a1]!=a3[a1]){aZ=true;break}}return aZ},rendLayerTips:function(a0){var aZ=ar.tipsCompareIsNew(a0.newMsg,am);if(aZ){if(a0.showTip){a0.newMsg.atlink=a0.linkMsg.atlink;a0.newMsg.userId=a0.linkMsg.userId;a0.newMsg.isNotice="";var a1=d(e(T,u),a0.newMsg);aV.tipsContent.innerHTML=a1;if(c.IE6){ar.adjustTopPos()}if(aV.layerNotice.style.display=="none"){aV.tipsLayer.style.display=""}}else{aV.tipsLayer.style.display="none";aV.tipsContent.innerHTML=""}}return aZ},rendNoticeTips:function(a1,a0){if(a0){a1.newMsg.isNotice=' class="message"';a1.linkMsg.showTip=a1.showTip;var a2=d(e(T,u),a1.newMsg);var a3=d(e(P,u),a1.linkMsg);var aZ=d(e(N,u),{newMsg:a2,linkMsg:a3});aV.noticeContent.innerHTML=aZ}delete a1.newMsg.isNotice;delete a1.newMsg.atlink;delete a1.newMsg.userId;am=a1.newMsg},rendTips:function(a1,a5){var a3=Y(a1,{});var a2=Y(av,{});var a4=a3.atme;var a6=a3.atcmt;a3.atme+=a3.atcmt;a2.atme+=a2.atcmt;if(aR){if(!a5){if(aE||ao){a3.msg=aF}}}var a0=ar.getTipsResult(a3,a2,a4,a6);var aZ=ar.rendLayerTips(a0);ar.rendNoticeTips(a0,aZ)},rendApp:function(a1){var aZ=a1.my_app;var a2=a1.offical_app;for(var a0=0;a0<a2.length;a0++){a2[a0].sname=F(a2[a0].name,8)}for(var a0=0;a0<aZ.length;a0++){aZ[a0].sname=F(aZ[a0].name,10)}aV.appContent.innerHTML=d(e(Z,u),a1)},rendGame:function(a1){for(var a0 in a1){if(D(a1[a0])){for(var aZ=0;aZ<a1[a0].length;aZ++){a1[a0][aZ].name=F(a1[a0][aZ].name,12)}if(a1[a0].length>6){a1[a0+"B"]=a1[a0].splice(6,6)}if(a1[a0].length>6){a1[a0]=a1[a0].splice(0,6)}}}aV.gameContent.innerHTML=d(e(s,u),a1)},rendGroup:function(a3){var a2;for(var a1 in a3){if(D(a3[a1])){for(var a0=0;a0<a3[a1].length;a0++){a3[a1][a0].g_name=F(a3[a1][a0].g_name,12);a2=parseInt(a3[a1][a0].g_new)||0;a2>99@(a2="99+"):(a2=a2.toString());a3[a1][a0].g_new=a2}if(a3[a1].length>10){a3[a1+"B"]=a3[a1].splice(10,10)}if(a3[a1].length>10){a3[a1]=a3[a1].splice(0,10)}}}aV.groupContent.innerHTML=d(e(B,u),a3);var aZ=m("ul.group_list li",aV.groupContent).length;if(aZ>10){aV.layerGroup.style.width="270px"}else{aV.layerGroup.style.width="135px"}},bindHover:function(aZ){o({act:aI[aZ].act,delay:aj,extra:[aI[aZ].layer],onmouseover:function(){ax.showHover(aZ)},onmouseout:function(){ax.hideHover(aZ)}})},surprise:function(aZ){var a0=ar.strFilter(aV.searchInput.value);if(aZ=="@"){aV.searchInput.value="";window.top.location.href=af+"/n/"+a0;return true}else{if(aZ=="#"){aV.searchInput.value="";window.top.location.href="../s.weibo.com/weibo/"+a0;return true}}return false},strFilter:function(aZ){return a(aZ).replace(/[\\\$\^\*\.\[\]\(\)\{\}\?]/g,"")}};var ax={emptySearchSubmit:function(a0){a0=ag(a0);if(a0.keyCode==13){var aZ=a(aV.searchInput.value);if(aZ==""&&!aT){window.top.location.href=J;return}}},loginBtn:function(){ar.showLoginLayer(ap);L()},closeTip:function(){aV.tipsLayer.style.display="none";aV.tipsContent.innerHTML="";aW.cleanTipsNumber.request();var a0={comment:1,attention:1,msg:1,atme:1,group:1,notice:1,invite:1,atcmt:1,photo:1};for(var aZ in a0){if(typeof av[aZ]!="undefined"){av[aZ]=0}}ar.rendTips(av);O.fire("refresh",av);L()},menuChoose:function(){var a2=arguments[0];var a0={};var a1=/^[\\|\/](.+)/;a0[g]=aV.home;a0[f]=aV.home;a0.home=aV.home;a2=a2.replace(a1,"$1").replace(/[\\|\/]/ig,"|");for(var aZ in a0){a0[aZ]&&r(a0[aZ],"current")}K.addClassName(a0[a2],"current")},searchInputCheck:function(aZ){if(aZ===""||aZ===e(S,u)){return false}else{return true}},searchFocus:function(){var a0=aV.searchInput,a1=ar.strFilter(a0.value),aZ=ax.searchInputCheck(a1);if(a1===e(S,u)){a0.value=""}if(aZ){ax.rendStatic(a1);ax.suggestShow();if(aC[a1]){ax.rendSuggest(aC[a1],a1)}}if(a0&&a0.parentNode){C(a0.parentNode,"search_current")}aQ=setInterval(ax.searchDetect,200)},searchBlur:function(){var aZ=aV.searchInput,a0=ar.strFilter(aZ.value);aV.searchInput.value=((a0==="")?e(S,u):aZ.value);if(aZ&&aZ.parentNode){r(aZ.parentNode,"search_current")}ax.suggestBlur();clearInterval(aQ)},suggestShow:function(){if(aJ){return}aV.searchSuggest.style.display="";i(document,"click",ax.suggestBlur);i(aV.searchInput,"keydown",ax.suggestKeySelect);aJ=1},suggestHide:function(){if(!aJ){return}aV.searchSuggest.style.display="none";p(document,"click",ax.suggestBlur);p(aV.searchInput,"keydown",ax.suggestKeySelect);aJ=0;ax.suggestClear()},suggestBlur:function(){var aZ=aV.searchSuggest,a0=aZ.parentNode,a1=ag().target;if(h(a1)&&G(a0,a1)){return false}else{ax.suggestHide()}},searchDetect:function(a2){var a0=aV.searchInput,a1=ar.strFilter(a0.value),aZ=ax.searchInputCheck(a1);if(aO==a1){return false}aO=a1;if(!aZ){ax.suggestHide();return false}else{ar.getSearchSuggest(a1)}},rendStatic:function(a1){var a0={keyword:R(a1.length>12?(F(a1,12)+"..."):a1),keywordlong:ar.wordFilter(a1)};var aZ=d(e(ae),a0).toString();aV.basic.innerHTML=ax.suggestHighLight(a1,aZ)},rendBasic:function(a0,a1){a0.imgPath=ak;a0.keywordlong=ar.wordFilter(a1);a0.keyword=R(a1.length>12?(F(a1,12)+"..."):a1);ar.setBasicSudaData("user_0",a0.userlist);ar.setBasicSudaData("key_0",a0.querys);if(a0.userlist||a0.querys){var aZ=d(e(X),a0).toString();aV.basic.innerHTML=ax.suggestHighLight(a1,aZ)}},rendPlus:function(a0,a1){a0.imgPath=ak;a0.keywordlong=ar.wordFilter(a1);a0.keyword=R(a1.length>12?(F(a1,12)+"..."):a1);ar.replaceWeiqunClass(a0.weiqun);a0.app&&(a0.app["rank"]=a0.app["rank"]*20);var aZ=d(e(I),a0).toString();aV.plus.innerHTML=ax.suggestHighLight(a1,aZ)},rendSuggest:function(a0,aZ){ax.rendBasic(a0,aZ);ax.rendPlus(a0,aZ)},suggestClear:function(){var a0=[aV.basic,aV.plus];for(var aZ=0;aZ<a0.length;aZ++){a0[aZ].innerHTML=""}aU=0},suggestHighLight:function(a1,a2){var aZ=new RegExp("<\\!\\-\\-start\\-\\->(.*?)<\\!\\-\\-end\\-\\->","ig");var a0=a2.replace(aZ,function(){return arguments[1].replace(new RegExp(a1,"g"),'<span node-type="input" class="c_red">'+a1+"</span>")});return a0},suggestSelectInit:function(){var aZ=aV.searchSuggest,a0=w(aZ);a0.add("select","mouseover",ax.suggestSelect);a0.add("select","click",ax.goSuggest)},suggestSelect:function(a2){var a1=m('[action-type="select"]',aV.searchSuggest),a0=ah(a2.el,a1),aZ=m(".current",aV.searchSuggest)[0];if(aU==a0||a0<0){return false}aZ&&r(aZ,"current");a1[a0]&&C(a1[a0],"current");aU=a0},suggestKeySelect:function(){var a2=ag(),a1=m('[action-type="select"]',aV.searchSuggest),a0=a1.length;if(a0){for(var aZ=0;aZ<a0;++aZ){if(V(a1[aZ],"current")){aU=aZ}r(a1[aZ],"current")}}if(a2.keyCode=="9"||a2.keyCode=="27"){ax.suggestHide();aV.searchInput.blur()}else{if(a2.keyCode=="38"){aU--}else{if(a2.keyCode=="40"){aU++}else{if(a2.keyCode=="13"){L();if(a2.ctrlKey==true){if(ar.surprise("@")){return false}}if(a2.shiftKey==true){if(ar.surprise("#")){return false}}ax.goSuggest({el:a1[aU]})}}}}if(aU<0){aU=a0-1}else{if(aU>(a0-1)){aU=0}}a1[aU]&&C(a1[aU],"current")},goSuggest:function(a2){aT=1;setTimeout(function(){aT=0},50);var a3=a(aV.searchInput.value);if(a3==""){window.top.location.href=J;return}aV.searchInput.value="";try{aV.searchInput.blur()}catch(a5){}if(a2.el){var a4=a2.evt&&a2.evt.type=="click";if(a4){ad(a2.evt)}var aZ=a2.el.getAttribute("suda-data");if(aZ){aZ=aZ.match(/key=.+?&value=(.+)$/)[1];if(!a4){aZ=aZ.replace(/c$/,"k")}if(window.SUDA){window.SUDA.uaTrack&&window.SUDA.uaTrack("tblog_top_search_v4",aZ)}else{window.GB_SUDA&&window.GB_SUDA._S_uaTrack&&window.GB_SUDA._S_uaTrack("tblog_top_search_v4",aZ)}}var a0=a2.el.getAttribute("isStatic")==="1";var a1=a2.el.getAttribute("durl");if(a0){a1=a1.replace(/\/[^\/]+?(?=\?topnav=1)/,"./"+ar.wordFilter(a3))}setTimeout(function(){window.top.location.href=a1},100)}ax.suggestHide()},goSearch:function(){var aZ=a(aV.searchInput.value);ad();if(aZ===""||aZ===e(S,u)){window.top.location.href=J}else{aV.searchInput.value="";window.top.location.href=ai+ar.wordFilter(aZ)+"@topnav=1"}},showHover:function(a0){var a2=aI[a0]["content"];if(ar.isVisible(a2)){return}if("notice|account".indexOf(a0)!=-1){aV.tipsLayer.style.display="none"}var a1=aI[a0]["act"];var aZ=aI[a0]["layer"];var a3=aN[a0];if(a0!="notice"&&a2&&(typeof a3=="undefined"||a3)){if(a0!="plaza"){a2.innerHTML=e(y)}ar.getLayerData(a0)}if(a1==aV[an]){r(a1,"current_page")}aZ.style.display="";C(a1,"current")},hideHover:function(a0){if("notice|account".indexOf(a0)!=-1){aV.tipsLayer.style.display=m("li",aV.tipsLayer).length?"":"none"}var a1=aI[a0]["act"];var aZ=aI[a0]["layer"];aZ.style.display="none";r(a1,"current");if(a1==aV[an]){C(a1,"current_page")}}};var aK={};var al={};var aX=function(){aq();aB();aG();ac();az();aY();ay();aH()};var aq=function(){var aZ=aL||window.$CONFIG||{};ap=Y({uid:"",onick:"",islogin:"",language:null,lang:"zh-cn",bigpipe:false,imgPath:q,page:null,setCover:false,backurl:"/",loginSuccessUrl:window.location.href,pid:0},aZ);if(ap.lang=="zh-tw"){ap.language=ap.language||K.common.extra.toplang}aL=aL||{};ap=Y(ap,aL);f=ap.uid;g=ap.onick;l=parseInt(ap.islogin)||0;u=ap.language;z=ap.bigpipe;an=ap.page;ak=ap.imgPath};var aB=function(){if(aL&&aL.html){aP.innerHTML=aL.html}aV=K.kit.dom.parseDOM(E(aP).list);aV[an]&&C(aV[an],"current_page");aV.searchInput.value=e(S,u);aV.searchInput.setAttribute("name",H());if(l){var a1=K.C("div");a1.innerHTML='<div class="layer_message_box" style="display:none;"><ul></ul><a class="W_close_color" href="javascript:void(0);"  action-type="closeTip"></a></div>';a1=a1.firstChild;m("div.header",aP)[0].appendChild(a1);aV.tipsLayer=a1;aV.tipsContent=m("ul",a1)[0];aV.closeTip=m('a[action-type="closeTip"]',a1)[0];aD.topHeight=m("div.global_header",aP)[0].offsetHeight;var a0={photo:1,comment:1,attention:1,msg:1,atme:1,group:1,notice:1,invite:1,userId:f};var aZ="<ul>"+d(e(P,u),a0)+"</ul>";aV.noticeContent.innerHTML=aZ;aV.exit.href=aV.exit.href.replace("backurl=/","backurl="+ap.backurl)}};var aG=function(){aI={application:{act:aV.app,layer:aV.layerApp,content:aV.appContent,cb:ar.rendApp},group:{act:aV.group,layer:aV.layerGroup,content:aV.groupContent,cb:ar.rendGroup},account:{act:aV.account,layer:aV.layerAccount},notice:{act:aV.notice,layer:aV.layerNotice,content:aV.noticeContent},game:{act:aV.game,layer:aV.layerGame,content:aV.gameContent,cb:ar.rendGame},plaza:{act:aV.plaza,layer:aV.layerPlaza,content:aV.plazaContent}}};var az=function(){if(!l){return}setTimeout(function(){ar.sendRequest();setInterval(ar.sendRequest,M)},3000);if(aR){aw=setTimeout(function(){if(ao){aE=1}else{aE=0}},30000)}};var aY=function(){i(aV.searchInput,"focus",ax.searchFocus);i(aV.searchInput,"blur",ax.searchBlur);i(aV.searchInput,"keydown",ax.emptySearchSubmit);i(aV.searchSubmit,"click",ax.goSearch);ax.suggestSelectInit();if(!l){i(aV.loginBtn,"click",ax.loginBtn);return}if(c.IE6){i(window,"scroll",ar.adjustTopPos);i(window,"resize",ar.adjustTopPos)}aA=w(aP);aA.add("dyn-click","click",function(a1){aV.searchInput.value="";window.top.location.href=a1.el.getAttribute("durl")});aA.add("bp-link","click",function(a1){if(window.$CONFIG&&window.$CONFIG.bpType==="main"){if(a1.data.hide==="true"){try{a1.el.blur()}catch(a2){}aV.layerNotice.style.display="none";r(aV.notice,"current")}}if(ao){if(a1.data.goMsg==="stop"){window.__PubSub__.publish("webim.messageTipClicked",true);ad(a1.evt)}}});var a0=["application","group","account","notice","game","plaza"];for(var aZ=0;aZ<a0.length;aZ++){ar.bindHover(a0[aZ])}if(z=="true"){K.historyM&&K.historyM.onpopstate&&K.historyM.onpopstate(ax.menuChoose)}i(aV.closeTip,"click",ax.closeTip)};var ay=function(){};var aH=function(){O.register("readed",ar.sendRequest);if(aR){window.__PubSub__.subscribe("webim.connected",ar.webimStarted);window.__PubSub__.subscribe("webim.showMessage",ar.webimShowMsg)}};aX();aS.destroy=function(){};aS.showLoginLayer=ar.showLoginLayer;return aS}});STK.pageletM.register("pl.content.top",function(c){var b=c.E("pl_content_top");var a=c.comp.content.top(b);return a});STK.pageletM.start();